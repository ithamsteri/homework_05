# Разработка прототипа

В прототипе применён паттерн [MVC]().

## Вопросы Василия

### Модифицируемость

**1. Вам требуется реализовать два новых графический примитива.**

Для добавления нового графического примитива нужно добавить два файла
в каталоге `shapes`, например `Line.h` и `Line.cpp`. Затем унаследоваться
от интерфейса `IShape`, который находится в `shapes/IShape.h` и реализовать
два метода, которые используются для сериализации объекта в текстовое
представление и десериализации.

Также для удобства создан файл `common.h`, чтобы было проще включать
заголовочные файлы.

_Итого для реализации двух новых графических примитивов потребуется:_
  * добавить четыре файла;
  * модифицировать один файл;
  * добавить два класса;
  * модифицировать нуль классов;
  * добавить четыре метода;
  * модифицировать нуль методов.

**2. Вам требуется добавить импорт/экспорт документа из/в базы(у) данных.**

Нужно создать класс реализующий два интерфейса `IImport` и `IExport`, для
иморта и экспорта данных из базы данных, создав файл в каталоге `storages`.

_Итого для реализации работы с БД потребуется:_
  * добавить один файл;
  * модифицировать нуль файлов;
  * добавить один класс;
  * модицировать нуль классов;
  * добавить два метода;
  * модифицировать нуль методов.

**3. Вам требуется добавить модификацию существующего в документе примитива,
например, изменение размера/цвета/...**

Все примитивы имеют сериализацию и десериализацию. Этим можно воспользоваться
и модифицировать примитив через этот интерфейс, т.к. в документе хранятся
примитивы в качестве указателя на базовый класс `IShape`.

Нужно добавить новый метод в `DocumentController` для модифицирования примитива
пользователем:

```cpp
  bool modifyShape(DocumentModel::id_type id, const std::string &data) {
    IShape *shape = model_->getShape(id);
    if (shape) {
      shape->writeData(data);
      return true;
    }
    return false;
  }
```

_Итого для реализации модификации примитива потребуется:_
  * Добавить нуль файлов;
  * Модифицировать один файл;
  * Добавить нуль классов;
  * Модифицировать один класс;
  * Добавить один метод;
  * Модифицировать нуль методов.

**4. Вам требуется добавить новую обработку документа, например, замена одних
графических примитивов на новые по определенному правилу.**

Всю логику можно реализоавать в контроллере. Но сначала нужно знать все ID
всех примитивово для последовательного обхода. Добавляем метод в модель:

```cpp
  auto getIDs() {
    std::vector<id_type> ids;
    ids.reserve(shapes_.size());

    for (const auto &pair : shapes_)
      ids.push_back(pair.first);

    return ids;
  }
```

Имея вектор со всеми ID примитивов - можно обработать их данные:

```cpp
  void processing() {
    DocumentModel *documentModel = new DocumentModel();

    for (const auto id : model_->getIDs()) {
      std::string data = getShape(id);
      // ... processing data ...
      documentModel->addShape( ... );
    }
    
    model_ = documentModel;
  }
```

_Итого для реализации обработки данных потребуется:_
  * Добавить нуль файлов;
  * Модифицировать два файла;
  * Добавить нуль классов;
  * Модифицировать два класса;
  * Добавить два метода;
  * Модифицировать нуль методов.

### Тестируемость

**1. Вам требуется проверить работу хранилища документа: файловая система,
база данных.**

Хранилище можно протестировать через контроллер документа, использовав методы
`load` и `store`.

_Ничего добавлять и модифицировать не нужно._

**2. Вам требуется проверить чтение шаблонного документа и его сохранения.**

Хранилище можно протестировать через контроллер документа, использовав методы
`load` и `store`.

_Ничего добавлять и модифицировать не нужно._

**3. Вам требуется проверить новую обработку документа.**

Можно работать с документом через контроллер документа пользуясь методами
`addShape` и `getShape`:

_Ничего добавлять и модифицировать не нужно._

**4. Вам требуется проверить отображение разных графических примитивов.**

Использование `addShape` у `DocumentController` вызывает перерисовку примитивов
у `DocumentView`.

_Ничего добавлять и модифицировать не нужно._
